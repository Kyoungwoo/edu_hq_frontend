<!-- pc -->
<ng-container *mobileHidden>
  <app-header-admin></app-header-admin>
  <ion-content>
    <app-row style="align-items: flex-start;">
      <app-col size="280px">
        <app-table type="card">
          <ion-toolbar slot="top" color="white">
            <app-row style="justify-content: space-between;">
              <app-col size="auto"><h5>필터</h5></app-col>
              <app-col size="auto"><app-button fill="translucent" style="width: 100px;" (click)="get(0)">검색</app-button></app-col>
            </app-row>
          </ion-toolbar>
          <tbody>
            <tr>
              <td>
                <app-select-scene [(ngModel)]="form.project_id"></app-select-scene>
              </td>
            </tr>
            <tr>
              <td>
                <app-select-contractor [project_id]="form.project_id" [(ngModel)]="form.master_company_id"></app-select-contractor>
              </td>
            </tr>
            <tr>
              <td>
                <app-select-contractor-company [project_id]="form.project_id" [master_company_id]="form.master_company_id" [(ngModel)]="form.company_id"></app-select-contractor-company>
              </td>
            </tr>
            <tr>
              <td>
                <app-select-approval-type [(ngModel)]="form.approval_cnt_answer"></app-select-approval-type>
              </td>
            </tr>
            <tr>
              <td>
                <app-input-group label="작성일">
                  <app-calendar [(ngModel)]="form.start_date" [max]="form.end_date"></app-calendar>
                  ~
                  <app-calendar [(ngModel)]="form.end_date" [max]="form.start_date"></app-calendar>
                </app-input-group>
              </td>
            </tr>
            <tr>
              <td>
                <app-input label="검색어" placeholder="검색어를 입력해주세요." [(ngModel)]="form.search_text"></app-input>
              </td>
            </tr>
          </tbody>
        </app-table>
      </app-col>
      <app-col>

        <ng-container *ngIf="res && res.rsCode === 0">

          <ion-toolbar color="white">
            <ion-buttons slot="start">
              <app-button fill="translucent">복사작성</app-button>
            </ion-buttons>
          </ion-toolbar>
          <ion-toolbar color="white">
            <h5>기안/임시저장 목록(총{{res?.rsObj?.row_count || 0 }}건)</h5>
          </ion-toolbar>

          <app-radio-group [(ngModel)]="selectItem">
            
            <app-table>
              <thead>
                <tr>
                  <th style="width: 40px;" rowspan="2"></th>
                  <th style="width: 40px;">No.</th>
                  <th>서식명</th>
                  <th>업체명</th>
                  <th>작성자</th>
                  <th>작성일</th>
                  <th>결재일</th>
                  <th>결재상태</th>
                </tr>
              </thead>
              <tbody>
                <tr class="button" *ngFor="let item of res?.rsMap; let i = index;" (click)="detail(item)">
                  <td style="width: 40px;"><app-radio color="white" size="small" name="check" [value]="item"></app-radio></td>
                  <td>{{ res.rsObj.row_count - form.limit_no - i }}</td>
                  <td>{{ item.ctgo_approval_module_name }}</td>
                  <td>{{ item.company_name }}</td>
                  <td>{{ item.user_name }}</td>
                  <td>{{ item.create_date }}</td>
                  <td>{{ item.max_approval_date }}</td>
                  <td>{{ item.approval_cnt_answer }}</td>
                </tr>
              </tbody>
            </app-table>

            <app-pager [totalCount]="res?.rsObj?.row_count" [limitNo]="form.limit_no" (pagerChange)="get($event)"></app-pager>

          </app-radio-group>

        </ng-container>

        <ng-container *ngIf="res && res.rsCode === 1008">

          <app-card>검색된 목록이 없습니다.</app-card>

        </ng-container>
        

      </app-col>
    </app-row>
  </ion-content>
</ng-container>

<!-- 모바일 -->
<ng-container *mobileShow>
  <ion-header>
    <ion-toolbar color="white">
      <ion-buttons slot="start">
        <ion-back-button></ion-back-button>
      </ion-buttons>
      <ion-title>기안/임시저장함</ion-title>
      <ion-buttons slot="end">
        <app-menu-button></app-menu-button>
      </ion-buttons>
    </ion-toolbar>
    <ion-toolbar color="white">
      <app-input-group>
        <app-input label="현장" value="수원 당수 현장" [readonly]="true"></app-input>
        <app-button (click)="openDetailSearch()">상세검색</app-button>
      </app-input-group>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ng-container>
      <app-card *ngFor="let item of res?.rsMap; let i = index;">
        <app-row style="align-items: flex-start;">
          <app-col>
            <h5>{{ item.ctgo_approval_module_name }}</h5>
          </app-col>
          <app-col size="auto">
            <ion-chip color="success">{{ item.approval_cnt_answer }}</ion-chip>
          </app-col>
        </app-row>
        <app-row>
          <app-col>
            <p>{{ item.company_name }}/{{ item.user_name }}</p>
            <p>작성일: {{ item.create_date }}</p>
            <p>결재일: {{ item.max_approval_date }}</p>
          </app-col>
        </app-row>
      </app-card>

      <ion-infinite-scroll threshold="100px" id="infinite-scroll" (ionInfinite)="getMobile($event)">
        <ion-infinite-scroll-content loading-spinner="dots">
        </ion-infinite-scroll-content>
      </ion-infinite-scroll>
    </ng-container>
  </ion-content>


