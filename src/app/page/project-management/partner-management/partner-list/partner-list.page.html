<app-header-admin></app-header-admin>

<ion-content style="--padding-top:15px">
  <app-row style="align-items: flex-start;">
    <app-col size="280px">
      <app-table type="card">
        <ion-toolbar slot="top" color="white">
          <app-row style="justify-content: space-between;">
            <app-col size="auto"><h5>필터</h5></app-col>
            <app-col size="auto">
              <app-button fill="translucent" style="width: 100px;" (click)="getList()">검색</app-button>
            </app-col>
          </app-row>
        </ion-toolbar>
        <tbody>
          <tr>
            <td>
              <app-select-scene></app-select-scene>
            </td>
          </tr>
          <tr>
            <td>
              <app-select-contractor></app-select-contractor>
            </td>
          </tr>
          <tr>
            <td>
              <app-input label="검색어" [(ngModel)]="form.search_text" placeholder="검색어를 입력해주세요."></app-input>
            </td>
          </tr>
        </tbody>
      </app-table>
    </app-col>
    <app-col>
      <ion-toolbar color="white">
        <ion-buttons slot="start">
          <app-col>
            <app-button *ngIf="user.userData.user_role === 'LH_HEAD' 
            || user.userData.user_role  === 'COMPANY_HEAD'" fill="translucent" (click)="edit()">신규 등록</app-button>
          </app-col>
        </ion-buttons>
      </ion-toolbar>        
      <ion-toolbar color="white">
        <h5>협력사 관리 목록 (총{{ res?.rsMap?.length}}건)</h5>
      </ion-toolbar>
        <app-table>
          <thead>
            <tr>
              <th>NO</th>
              <th>현장명</th>
              <th>원청사명</th>
              <th>협력사명</th>
              <th>사업자등록번호</th>
              <th>대표자</th>
              <th>공종</th>
              <th>전화번호</th>
              <th>최근 업데이트</th>
              <th>작성자</th>
            </tr>
          </thead>
            <tr class="button" *ngFor="let item of res?.rsMap let i = index" (click)="edit(item)">
              <td>{{ i+1 }}</td>
              <td>{{ item.project_name }}</td>
              <td>{{ item.master_company_name }}</td>
              <td>{{ item.company_name }}</td>
              <td>{{ item.business_register_no }}</td>
              <td>{{ item.company_ceo}}</td>
              <td>{{ item.ctgo_construction_name }}</td>
              <td>{{ item.company_phone }}</td>
              <td>{{ item.update_date }}</td>
              <td>{{ item.create_user_name}}</td>
            </tr>
          <tbody>
          </tbody>
        </app-table>
        <app-pager [totalCount]="res?.rsObj.row_count" [limitNo]="form.limit_no" (pagerChange)="getList($event)"></app-pager>
    </app-col>
  </app-row>
</ion-content>
